import { db } from '../db/index.js';
import { terms } from '../db/schema.js';
import { eq } from 'drizzle-orm';

const termsData = [
    {
        code: 'service',
        title: '서비스 이용약관',
        content: `# mimy 서비스 이용약관

**시행일: 2026년 2월 10일**

mimy 서비스를 이용해 주셔서 감사합니다. 본 약관은 mimy 서비스 이용에 관한 회사와 회원 간의 권리, 의무 및 책임사항을 규정합니다.

---

## 제1장 총칙

### 제1조 (목적)
본 약관은 mimy(이하 "회사")가 제공하는 맛집 추천 및 리뷰 서비스(이하 "서비스")의 이용조건과 절차, 회사와 회원의 권리·의무 및 책임사항을 규정함을 목적으로 합니다.

### 제2조 (용어의 정의)
1. **서비스**란 회사가 제공하는 맛집 추천, 리뷰 작성, 랭킹 관리, 소셜 기능 등 일체의 서비스를 말합니다.
2. **회원**이란 본 약관에 동의하고 회사와 이용계약을 체결한 자를 말합니다.
3. **게시물**이란 회원이 서비스 내에 게시한 리뷰, 사진, 댓글 등 모든 콘텐츠를 말합니다.

### 제3조 (약관의 효력 및 변경)
1. 본 약관은 서비스 화면에 게시하거나 기타 방법으로 회원에게 공지함으로써 효력이 발생합니다.
2. 회사는 필요한 경우 관련 법령을 위배하지 않는 범위에서 약관을 변경할 수 있으며, 변경 시 **시행일 7일 전**부터 서비스 내 공지합니다.
3. 변경된 약관에 동의하지 않는 회원은 서비스 이용을 중단하고 탈퇴할 수 있습니다.

---

## 제2장 서비스 이용

### 제4조 (이용계약의 성립)
1. 이용계약은 회원이 되고자 하는 자가 약관에 동의하고 회원가입을 신청한 후, 회사가 이를 승낙함으로써 성립합니다.
2. 회사는 다음 각 호에 해당하는 경우 가입을 거부하거나 사후에 이용계약을 해지할 수 있습니다:
   - 만 14세 미만인 경우
   - 타인의 정보를 도용한 경우
   - 이전에 회원자격을 상실한 자로서 회사의 재가입 승낙을 얻지 못한 경우

### 제5조 (서비스의 제공)
1. 회사는 다음과 같은 서비스를 제공합니다:
   - 개인화된 맛집 추천 (Match Score 기반)
   - 맛집 리뷰 및 랭킹 작성
   - 미식 성향 분석 (퀴즈 기반 클러스터링)
   - 소셜 기능 (팔로우, 좋아요, 댓글)
2. 서비스는 연중무휴, 1일 24시간 제공을 원칙으로 합니다. 단, 시스템 점검 등 회사가 필요한 경우 서비스를 일시 중단할 수 있습니다.

### 제6조 (서비스 이용의 제한 및 중지)
1. 회사는 다음 각 호의 경우 서비스 이용을 제한하거나 중지할 수 있습니다:
   - 서비스용 설비의 보수 등 공사로 인한 부득이한 경우
   - 회원이 본 약관의 의무를 위반한 경우
   - 기타 불가항력적 사유가 있는 경우
2. **12개월 이상** 서비스에 로그인하지 않은 회원의 계정은 휴면 처리될 수 있습니다.

---

## 제3장 권리와 의무

### 제7조 (회원의 의무)
회원은 다음 각 호의 행위를 하여서는 안 됩니다:
1. 허위 정보 등록 또는 타인의 정보 도용
2. 회사 또는 제3자의 지적재산권 침해
3. 회사 또는 제3자의 명예를 손상시키거나 업무를 방해하는 행위
4. 음란물, 욕설, 비방 등 불건전한 내용의 게시물 게시
5. 영리 목적의 광고성 정보 전송
6. 서비스의 안정적 운영을 방해하는 행위
7. 기타 관련 법령에 위반되는 행위

### 제8조 (게시물의 권리와 책임)
1. 회원이 작성한 게시물의 저작권은 해당 회원에게 귀속됩니다.
2. 회원은 자신이 게시한 게시물에 대해 회사에게 다음의 권리를 부여합니다:
   - 서비스 내 게시물의 복제, 전송, 전시
   - 서비스 홍보 목적의 게시물 사용
   - 검색 결과 노출 및 관련 프로모션
3. 회사는 회원의 게시물이 제7조를 위반한 경우 사전 통지 없이 삭제하거나 비공개 처리할 수 있습니다.

### 제9조 (회사의 의무)
1. 회사는 관련 법령과 본 약관이 금지하는 행위를 하지 않으며, 지속적이고 안정적인 서비스 제공을 위해 노력합니다.
2. 회사는 회원의 개인정보를 보호하기 위해 보안 시스템을 갖추고 개인정보처리방침을 준수합니다.

---

## 제4장 기타

### 제10조 (계약 해지)
1. 회원은 언제든지 서비스 내 설정 메뉴를 통해 탈퇴를 요청할 수 있으며, 회사는 즉시 탈퇴를 처리합니다.
2. 회원 탈퇴 시 회원이 작성한 게시물은 삭제되지 않으며, 삭제를 원할 경우 탈퇴 전에 직접 삭제해야 합니다.

### 제11조 (면책조항)
1. 회사는 천재지변 또는 이에 준하는 불가항력으로 인해 서비스를 제공할 수 없는 경우 책임이 면제됩니다.
2. 회사는 회원의 귀책사유로 인한 서비스 이용 장애에 대해 책임을 지지 않습니다.
3. 회사는 회원이 게시한 정보의 신뢰성, 정확성에 대해 책임을 지지 않습니다.

### 제12조 (분쟁 해결)
1. 본 약관은 대한민국 법률에 따라 규율되고 해석됩니다.
2. 서비스 이용과 관련하여 회사와 회원 간에 분쟁이 발생한 경우, 양 당사자는 분쟁 해결을 위해 성실히 협의합니다.
3. 협의가 이루어지지 않을 경우 민사소송법상의 관할법원에 소를 제기할 수 있습니다.

---

**부칙**
본 약관은 2026년 2월 10일부터 시행됩니다.`,
        summary: '서비스 이용에 관한 기본 약관입니다.',
        is_required: true,
        version: '1.1',
        country_code: 'ALL',
        effective_date: '2026-02-10',
    },
    {
        code: 'privacy',
        title: '개인정보 처리방침',
        content: `# mimy 개인정보 처리방침

**시행일: 2026년 2월 10일**

mimy(이하 "회사")는 회원의 개인정보를 소중히 여기며, 「개인정보 보호법」 등 관련 법령을 준수합니다.

---

## 1. 수집하는 개인정보

### 필수 항목
| 수집 항목 | 수집 목적 |
|----------|----------|
| 휴대폰 번호 | 본인 확인, 계정 복구 |
| 생년월일 | 연령 확인 (만 14세 이상) |
| 소셜 계정 정보 | 간편 로그인 |

### 선택 항목
| 수집 항목 | 수집 목적 |
|----------|----------|
| 프로필 사진, 닉네임 | 프로필 표시 |
| 위치 정보 | 주변 맛집 추천 |
| 회사/학교 이메일 | 소속 인증 |

### 자동 수집 항목
- 서비스 이용 기록, 접속 로그
- 기기 정보 (기기 식별자, OS 버전)
- 쿠키

---

## 2. 개인정보의 이용 목적

- **서비스 제공**: 맛집 추천, 리뷰 기능, 소셜 기능
- **회원 관리**: 본인 확인, 부정 이용 방지
- **서비스 개선**: 이용 통계 분석, 맞춤 서비스 개발

---

## 3. 개인정보의 보유 기간

| 항목 | 보유 기간 |
|-----|----------|
| 회원 정보 | 회원 탈퇴 시까지 |
| 서비스 이용 기록 | 3년 |
| 부정 이용 기록 | 1년 |

※ 관련 법령에 따라 보존이 필요한 경우 해당 기간 동안 보관합니다.

---

## 4. 개인정보의 제3자 제공

회사는 원칙적으로 회원의 개인정보를 외부에 제공하지 않습니다.
단, 다음의 경우는 예외로 합니다:
- 회원이 사전에 동의한 경우
- 법령에 따른 요청이 있는 경우

---

## 5. 회원의 권리

회원은 언제든지 다음의 권리를 행사할 수 있습니다:
- 개인정보 열람, 정정, 삭제 요청
- 개인정보 처리 정지 요청
- 동의 철회 (회원 탈퇴)

**문의**: privacy@mimy.app

---

## 6. 개인정보의 안전성 확보 조치

회사는 개인정보의 안전성 확보를 위해 다음의 조치를 취하고 있습니다:
- 개인정보의 암호화
- 접근 권한 관리
- 보안 프로그램 설치 및 주기적 점검

---

## 7. 개인정보 보호책임자

- **담당**: 개인정보 보호팀
- **이메일**: privacy@mimy.app

---

**부칙**
본 방침은 2026년 2월 10일부터 시행됩니다.
변경 시 시행일 7일 전부터 서비스 내 공지합니다.`,
        summary: '개인정보 수집 및 이용에 관한 방침입니다.',
        is_required: true,
        version: '1.1',
        country_code: 'ALL',
        effective_date: '2026-02-10',
    },
    {
        code: 'marketing',
        title: '마케팅 정보 수신 동의',
        content: `# 마케팅 정보 수신 동의

mimy의 다양한 소식과 혜택을 받아보세요.

---

## 수신 내용
- 신규 기능 및 서비스 안내
- 이벤트 및 프로모션 정보
- 맞춤형 맛집 추천 알림

## 수신 방법
- 앱 푸시 알림
- 이메일

## 동의 철회
설정 > 알림 설정에서 언제든지 수신을 거부할 수 있습니다.

---

**본 동의는 선택 사항이며, 동의하지 않아도 서비스 이용에 제한이 없습니다.**

시행일: 2026년 2월 10일`,
        summary: '이벤트 및 혜택 알림 수신에 관한 동의입니다.',
        is_required: false,
        version: '1.1',
        country_code: 'ALL',
        effective_date: '2026-02-10',
    },
];

async function updateTerms() {
    console.log('Starting terms update...');

    for (const termData of termsData) {
        try {
            // Update existing term
            const result = await db
                .update(terms)
                .set({
                    title: termData.title,
                    content: termData.content,
                    summary: termData.summary,
                    is_required: termData.is_required,
                    version: termData.version,
                    effective_date: termData.effective_date,
                    updated_at: new Date(),
                })
                .where(eq(terms.code, termData.code));

            console.log(`Updated term: ${termData.code}`);
        } catch (error) {
            console.error(`Error updating term ${termData.code}:`, error);
        }
    }

    console.log('Terms update completed!');
    process.exit(0);
}

updateTerms();
